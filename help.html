<!DOCTYPE html>
<html>

<head>
	<base target="_top">
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700,300&amp;subset=latin,latin-ext' rel='stylesheet' type='text/css'>
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400" rel="stylesheet">

<style>

	body {
		font-family:  sans-serif;
		line-height: 1.25;
	}

	li {
		margin-top: 5px;
	}

</style>

</head>

<body>


<!-- <div style="width:725px;height:700px;background:#f3f3f3;margin:auto;margin-top:100px;padding:20px;overflow-y: scroll"> -->

	<p>
	The Mail Merge code will create individualized (merged) PDFs from a Google Doc Template, save the PDFs to a specified Google Drive folder, and then send emails to a recipient list with the PDF attached.
	</p>

	<p>All Mail Merge functionality is accessed from the <em><b>Mail Merge</b></em> menu item, which includes the following items:</p>
	<ul>
		<li>Create PDF and Send</li>
		<li>Send Test Email</li>
	</ul>

	<h3 style="color:blue"><strong><em>Create PDF and Send</em></strong></h3>
	<div style="margin-left:10px">
		<p>This menu item will process each row on the <em><b>Data</b></em> tab and perform the following operations:</p>
		<ul>
			<li>Merge each row's data into a copy of the Doc Template entitled <em>Copy of Doc Template</em>. The data is merged based upon "{}" markers inserted into the Template, where the row's column name equals the contents of the marker: <span style="background-color:#ffff00">{column_name}</span>. Markers may be placed anywhere in the document and may be repeated. The only requirement is they must contain the value of a column header from the Data tab e.g. "{first name}". The markers are then replaced with the corresponding data.</li>

			<li>Create a PDF document from the merged <em>Copy of Doc Template</em></li>
			<li>Save the newly created PDF to the specified Google Drive folder (from the "Config" tab)</li>
			<li>Delete <em>Copy of Doc Template</em></li>
			<li>Send an email to the email address in the "email" column</li>
			<ul>
				<li>The email body may contain "{}" markers as well (in any quantity and may be repeated), and data will be merged from the Data tab into the email body</li>
			</ul>
		</ul>
	</div>

	<h3 style="color:blue"><strong><em>Send Test Email</em></strong></h3>

	<div style="margin-left: 10px;">
		<ul>
			<li>Same as <em>Create PDF and Send</em>, except that it pulls data from the <em>Test Data</em> tab instead of the <em>Data</em> tab. Typically you would want just one or two rows of data for testing.</li>
		</ul>

	</div>

	<p>The following tab, with exact case sensitive name, must exist in any order. Any other tabs are allowed.</p>
	<ul>
		<li>[Display]</li>
	</ul>

	<h3>[Display] Tab</h3>

	<ul>
		<li>The Display tab may contain any number of columns, with any title, and in any order</li>
		<li>Columns entitled "pdf created" and "email sent" are required and are case sensitive (must be all lowercase)</li>
		<li>The program will fill in the <em>pdf created</em> and <em>email sent</em> columns with either "yes", "no" or an error message</li>
		<li>When a row is successfully processed it will be colored green. If either the PDF creation or the email send fails, the row will be colored red.</li>
		<li>To reprocess the rows on the Data tab, where one or more rows have failed, clear the values in the <em>pdf created</em> and <em>email sent</em> columns in the failed row(s), and select Create PDF and Send. Rows that were previously processed successfully will be skipped. You do not need to delete these rows to avoid processing them twice. </li>
	</ul>


<!-- </div> -->

</body>

</html>